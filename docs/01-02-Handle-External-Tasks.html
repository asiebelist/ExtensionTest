

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Handle External Tasks &mdash; AtlasEngineClient.NET 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Integrations" href="02-Integrations.html" />
    <link rel="prev" title="Starting new process instances" href="01-01-Start-Processes.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> AtlasEngineClient.NET
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="01-Getting-Started.html">Getting started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01-01-Start-Processes.html">Starting new process instances</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Handle External Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-the-external-task-client">Create the External Task Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subscribe-to-a-topic">Subscribe to a topic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#choosing-a-call-strategy">Choosing a call strategy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#methods-handlers">Methods handlers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#typed-handlers">Typed handlers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#typed-handlers-using-custom-activators">Typed handlers using custom activators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#customize-the-behavior">Customize the behavior</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="02-Integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-Samples.html">Samples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AtlasEngineClient.NET</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="01-Getting-Started.html">Getting started</a> &raquo;</li>
        
      <li>Handle External Tasks</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/01-02-Handle-External-Tasks.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="handle-external-tasks">
<span id="id1"></span><h1>Handle External Tasks<a class="headerlink" href="#handle-external-tasks" title="Permalink to this headline">¶</a></h1>
<p>Handling External Tasks is your bread and butter mechanism for process
automation. We’ll introduce you to the basics.</p>
<div class="section" id="create-the-external-task-client">
<h2>Create the External Task Client<a class="headerlink" href="#create-the-external-task-client" title="Permalink to this headline">¶</a></h2>
<p>Create an <code class="docutils literal notranslate"><span class="pre">ExternalTaskClient</span></code> instance using this</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">addressOfAtlasEngine</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Uri</span><span class="p">(</span><span class="s">&quot;[Engine Endpoint]&quot;</span><span class="p">);</span>
<span class="kt">var</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="n">ExternalTaskClient</span><span class="p">(</span><span class="n">addressOfAtlasEngine</span><span class="p">);</span>
</pre></div>
</div>
<p>You can specify a custom identity accessor and a logger implementation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since we omitted the identity accessor parameter, we are working anonymously.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By not specifiying a logger, no diagnosable information is disclosed. We
are recommending specifying a logger, but not forcing it onto you. There’s
also a <code class="docutils literal notranslate"><span class="pre">ConsoleLogger</span></code> implementation dumping to <code class="docutils literal notranslate"><span class="pre">StdOut</span></code> and <code class="docutils literal notranslate"><span class="pre">Debug</span></code>.</p>
</div>
</div>
<div class="section" id="subscribe-to-a-topic">
<h2>Subscribe to a topic<a class="headerlink" href="#subscribe-to-a-topic" title="Permalink to this headline">¶</a></h2>
<p>The External Tasks you have modeled, will have a topic assigned, which you
can subscribe to</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="p">.</span><span class="n">SubscribeToExternalTaskTopic</span><span class="p">(</span>
    <span class="s">&quot;[Topic]&quot;</span><span class="p">,</span>
    <span class="n">p</span> <span class="p">=&gt;</span> <span class="n">p</span><span class="p">.[</span><span class="n">Choose</span> <span class="n">call</span> <span class="n">strategy</span><span class="p">]);</span>

<span class="n">client</span><span class="p">.</span><span class="n">StartAsync</span><span class="p">();</span>

<span class="n">client</span><span class="p">.</span><span class="n">StopAsync</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="choosing-a-call-strategy">
<h2>Choosing a call strategy<a class="headerlink" href="#choosing-a-call-strategy" title="Permalink to this headline">¶</a></h2>
<p>Since handler activation is highly depending on your needs, there is no
appropriate default. But don’t worry, there is some help provided!
To avoid a type analysis at runtime, we encourage you to provide us the type
information.</p>
<div class="section" id="methods-handlers">
<h3>Methods handlers<a class="headerlink" href="#methods-handlers" title="Permalink to this headline">¶</a></h3>
<p>To use a method as your handler pass in a delegate.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">CallStrategySelector</span><span class="p">.</span><span class="n">UseHandlerMethod</span><span class="p">&lt;</span><span class="n">TInput</span><span class="p">,</span> <span class="n">TOutput</span><span class="p">&gt;([</span><span class="n">Your</span> <span class="n">Method</span><span class="p">])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It may be async by returning a <code class="docutils literal notranslate"><span class="pre">Task&lt;TOutput&gt;</span></code>, too.</p>
</div>
</div>
<div class="section" id="typed-handlers">
<h3>Typed handlers<a class="headerlink" href="#typed-handlers" title="Permalink to this headline">¶</a></h3>
<p>Switching to typed handlers requires you to implement <cite>IExternalTaskHandler&lt;TInput, TOutput&gt;</cite>.
For activation you can specify a factory method as the call strategy:</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">CallStrategySelector</span><span class="p">.</span><span class="n">UseHandlerFactory</span><span class="p">&lt;</span><span class="n">THandler</span><span class="p">,</span> <span class="n">TInput</span><span class="p">,</span> <span class="n">TOutput</span><span class="p">&gt;(()</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="n">THandler</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="typed-handlers-using-custom-activators">
<h3>Typed handlers using custom activators<a class="headerlink" href="#typed-handlers-using-custom-activators" title="Permalink to this headline">¶</a></h3>
<p>For more advanced scenarios, you can specify an custom Activator.
This is the way to resolve handlers using an IoC container.</p>
<div class="highlight-csharp notranslate"><div class="highlight"><pre><span></span><span class="n">CallStrategySelector</span><span class="p">.</span><span class="n">UseHandlerActivator</span><span class="p">&lt;</span><span class="n">THandler</span><span class="p">,</span> <span class="n">TInput</span><span class="p">,</span> <span class="n">TOutput</span><span class="p">&gt;([</span><span class="n">Some</span> <span class="n">Activator</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="customize-the-behavior">
<h2>Customize the behavior<a class="headerlink" href="#customize-the-behavior" title="Permalink to this headline">¶</a></h2>
<p>Fetching tasks and dispatching them to your handlers involves some more work,
but we have chosen to hide it in the library. You can tweak it though by providing
<code class="docutils literal notranslate"><span class="pre">WorkerSettings</span></code> when configuring the topic subscription…</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">WorkerId</span></code>
This is useful on clusters. If you’d like to trace which worker handled a
specific task, you can provide it here. An empty worker ID is substituted
by an uniquely generated ID.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MaxParallelWorkerCount</span></code>
As soon as an External Task is fetched, we’ll dispatch it to your handler.
You can have multiple handlers active at the same time to scale out.
The default is set to <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LongPollingDuration</span></code>
Sometimes there’s just no work to be done. We’ll use long-polling to keep
the connection open while fetching. The default is <code class="docutils literal notranslate"><span class="pre">30s</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LockDuration</span></code>
Your handler may take some time to process. A self-terminating lock keeps
other handlers from claiming the task while you are busy. The lock is
periodically refreshed as some sort of keep-alive. The default is <code class="docutils literal notranslate"><span class="pre">15s</span></code>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="02-Integrations.html" class="btn btn-neutral float-right" title="Integrations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="01-01-Start-Processes.html" class="btn btn-neutral float-left" title="Starting new process instances" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Alle

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>